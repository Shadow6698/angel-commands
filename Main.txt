-- SCRIPT ULTRA-OTIMIZADO SEM DELAYS - PREFIX (:)
if getgenv().UltraCommandsLoaded then
    return warn("Script j√° ativo!")
end
getgenv().UltraCommandsLoaded = true

-- CACHE GLOBAL PR√â-CARREGADO
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")

local prefix = ":"
local chatEnabled = true
local xrayActive = false
local xrayParts = {}

-- CACHE DE REFER√äNCIAS PARA M√ÅXIMA VELOCIDADE
local playerGui = LocalPlayer:WaitForChild("PlayerGui")
local char, hum, root

-- FUN√á√ÉO DE CACHE INSTANT√ÇNEO
local function UpdateCache()
    char = LocalPlayer.Character
    if char then
        hum = char:FindFirstChildOfClass("Humanoid")
        root = char:FindFirstChild("HumanoidRootPart")
    end
end

-- ATUALIZAR CACHE QUANDO SPAWN
LocalPlayer.CharacterAdded:Connect(UpdateCache)
UpdateCache()

-- MENSAGEM INSTANT√ÇNEA (REUTILIZ√ÅVEL)
local msgGui
local function Msg(text)
    if msgGui then 
        msgGui:Destroy() 
    end
    
    msgGui = Instance.new("ScreenGui")
    msgGui.Name = "QuickMsg"
    msgGui.Parent = playerGui
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0.4, 0, 0.06, 0)
    label.Position = UDim2.new(0.3, 0, 0.47, 0)
    label.BackgroundColor3 = Color3.new(0, 0, 0)
    label.BackgroundTransparency = 0.2
    label.BorderSizePixel = 0
    label.Text = text
    label.TextColor3 = Color3.new(0, 1, 0)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 20
    label.TextStrokeTransparency = 0
    label.ZIndex = 999
    label.Parent = msgGui
    
    -- DESTRUIR AP√ìS 1.5s SEM COROUTINE
    game:GetService("Debris"):AddItem(msgGui, 1.5)
end

-- TELEPORTS PR√â-CARREGADOS (OTIMIZADOS)
local tps = {
    salao = CFrame.new(-76, 4, -123), sofa = CFrame.new(-82, 22, -128),
    doceria = CFrame.new(-125, 6, -120), jogos = CFrame.new(-172, 1, -126),
    delegacia = CFrame.new(-121, 4, 31), hospital = CFrame.new(-293, 4, 40),
    banco = CFrame.new(-358, 25, -143), bombeiros = CFrame.new(-469, 6, -122),
    cemiterio = CFrame.new(-486, 7, 56), escola = CFrame.new(-315, 6, 211),
    creche = CFrame.new(-157, 4, 125), caixas = CFrame.new(-162, 4, 268),
    lanches = CFrame.new(-169, 20, 291), livraria = CFrame.new(-129, 4, 259),
    celulares = CFrame.new(-127, 21, 253), coffes = CFrame.new(-96, 5, 250),
    veterinario = CFrame.new(-100, 22, 262), dentista = CFrame.new(-53, 20, 268),
    banco2 = CFrame.new(3, 4, 257), hotel = CFrame.new(199, 2, 182),
    hamburgueria = CFrame.new(156, 8, 39), aeroporto = CFrame.new(317, 7, 40),
    shopping = CFrame.new(165, 5, -158), ap1 = CFrame.new(-35, 20, -126),
    ap2 = CFrame.new(-34, 37, -136), igreja = CFrame.new(-64, 37, -192),
    praia1 = CFrame.new(70, 8, -1433), praia2 = CFrame.new(-218, 1, 760),
    praia3 = CFrame.new(15, 4, 1460), abandonada = CFrame.new(1044, 8, 54),
    maquinas = CFrame.new(235, 4, 813), iate = CFrame.new(-125, 33, 856),
    cabana = CFrame.new(-249, 6, 1078), drones = CFrame.new(-680, 252, 762),
    fazenda1 = CFrame.new(-851, 6, -57), fazenda2 = CFrame.new(-863, 6, -375),
    ["pra√ßa"] = CFrame.new(-13, 6, -17), montanha = CFrame.new(-580, 1, 1026),
    posto = CFrame.new(133, 2, -338), loja = CFrame.new(-39, 2, 255),
    parque = CFrame.new(180, 5, -173)
}

-- SCRIPTS PR√â-CARREGADOS
local scripts = {
    speedsupreme = "https://raw.githubusercontent.com/Shadow6698/Speed-2/main/Main.txt",
    coolkid = "https://raw.githubusercontent.com/Shadow6698/COOLKIDHUB/main/Main.txt",
    portalgun = "https://raw.githubusercontent.com/Shadow6698/Portal-gun-/main/Main.txt",
    void = "https://raw.githubusercontent.com/Shadow6698/Void-fe/main/main.txt",
    gravitygun = "https://scriptblox.com/raw/Universal-Script-Telekinesis-12332",
    angelhub = "https://raw.githubusercontent.com/Shadow6698/hubmystery/main/Main.txt",
    lanterna = "https://raw.githubusercontent.com/lumpiasallad/Flashlight-Script-roblox/refs/heads/main/Flashlight.lua",
    cmd1 = "https://raw.githubusercontent.com/ltseverydayyou/Nameless-Admin/main/Source.lua",
    hub1 = "https://raw.githubusercontent.com/Venom-devX/ChaosHub/main/loader.lua",
    emotes = "https://pastebin.com/raw/eCpipCTH",
    gigante = "https://rawscripts.net/raw/Brookhaven-RP-FE-BIG-AVATAR-43381",
    bola = "https://rawscripts.net/raw/Universal-Script-Fe-ball-rolL-9835",
    bughub = "https://rawscripts.net/raw/Brookhaven-RP-Glitch-fe-44756",
    infinite = "https://pastebin.com/raw/zqyDSUWX",
    noclip = "https://pastebin.com/raw/BK4Q0DfP",
    invisible = "https://rawscripts.net/raw/Brookhaven-RP-Avatar-invisible-45072"
}

-- BUSCA INSTANT√ÇNEA DE JOGADOR (OTIMIZADA)
local function FindPlayer(name)
    if not name then return end
    local lowerName = name:lower()
    local nameLen = #lowerName
    
    for _, player in pairs(Players:GetPlayers()) do
        if player.Name:lower():sub(1, nameLen) == lowerName or 
           player.DisplayName:lower():sub(1, nameLen) == lowerName then
            return player
        end
    end
end

-- JOGADOR ALEAT√ìRIO INSTANT√ÇNEO (OTIMIZADO)
local function GetRandomPlayer()
    local validPlayers = {}
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
            table.insert(validPlayers, p)
        end
    end
    return validPlayers[math.random(#validPlayers)]
end

-- CARREGAMENTO INSTANT√ÇNEO DE SCRIPT (SEM YIELD)
local function LoadScript(url)
    spawn(function()
        local success, result = pcall(function()
            return game:HttpGet(url)
        end)
        if success and result then
            pcall(loadstring(result))
        end
    end)
end

-- XRAY INSTANT√ÇNEO (OTIMIZADO)
local function ToggleXray()
    if xrayActive then
        -- DESATIVAR
        for i = 1, #xrayParts do
            local data = xrayParts[i]
            if data.part and data.part.Parent then
                data.part.Transparency = data.original
            end
        end
        xrayParts = {}
        xrayActive = false
        Msg("üëª XRAY OFF")
    else
        -- ATIVAR
        xrayParts = {}
        local partIndex = 0
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("BasePart") and obj.Transparency < 1 and obj.CanCollide then
                partIndex = partIndex + 1
                xrayParts[partIndex] = {part = obj, original = obj.Transparency}
                obj.Transparency = 0.7
            end
        end
        xrayActive = true
        Msg("üëª XRAY ON")
    end
end

-- PROCESSAMENTO INSTANT√ÇNEO DE COMANDOS (ULTRA-OTIMIZADO)
local function ProcessCmd(cmd, args)
    if not root or not hum then
        UpdateCache()
        if not root or not hum then return end
    end
    
    -- TELEPORTS INSTANT√ÇNEOS
    if cmd == "tp" and args[2] then
        if args[2] == "random" then
            local target = GetRandomPlayer()
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                root.CFrame = target.Character.HumanoidRootPart.CFrame + Vector3.new(0, 2, 0)
                Msg("‚Üí " .. target.Name)
            else
                Msg("‚ùå Sem jogadores")
            end
        elseif tps[args[2]] then
            root.CFrame = tps[args[2]]
            Msg("‚Üí " .. args[2])
        else
            local target = FindPlayer(args[2])
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                root.CFrame = target.Character.HumanoidRootPart.CFrame + Vector3.new(0, 2, 0)
                Msg("‚Üí " .. target.Name)
            else
                Msg("‚ùå Jogador n√£o encontrado")
            end
        end
        
    -- SOF√Å ESPECIAL
    elseif cmd == "tpsofa" then
        root.CFrame = CFrame.new(-83, 21, -131)
        hum:ChangeState(Enum.HumanoidStateType.Seated)
        Msg("‚Üí Sof√° secreto")
        
    -- VELOCIDADE INSTANT√ÇNEA
    elseif cmd == "speed" then
        local speed = tonumber(args[2]) or 16
        hum.WalkSpeed = speed
        Msg("‚ö° Speed: " .. speed)
        
    elseif cmd == "resetspeed" then
        hum.WalkSpeed = 16
        Msg("‚ö° Speed resetado")
        
    -- JUMP POWER INSTANT√ÇNEO
    elseif cmd == "jp" then
        local jump = tonumber(args[2]) or 50
        hum.JumpPower = jump
        Msg("üöÄ Jump: " .. jump)
        
    elseif cmd == "jumppower" then
        local jump = tonumber(args[2]) or 50
        hum.JumpPower = jump
        Msg("üöÄ Jump: " .. jump)
        
    elseif cmd == "resetjp" then
        hum.JumpPower = 50
        Msg("üöÄ Jump resetado")
        
    -- VIEW INSTANT√ÇNEO
    elseif cmd == "view" and args[2] then
        local target = FindPlayer(args[2])
        if target and target.Character then
            local targetHum = target.Character:FindFirstChildOfClass("Humanoid")
            if targetHum then
                Camera.CameraSubject = targetHum
                Msg("üëÅÔ∏è " .. target.Name)
            end
        end
        
    elseif cmd == "unview" then
        Camera.CameraSubject = hum
        Msg("üëÅÔ∏è C√¢mera resetada")
        
    -- XRAY INSTANT√ÇNEO
    elseif cmd == "xray" then
        ToggleXray()
        
    elseif cmd == "unxray" then
        if xrayActive then ToggleXray() end
        
    -- CHAT TOGGLE
    elseif cmd == "chat" then
        chatEnabled = not chatEnabled
        Msg(chatEnabled and "üí¨ Chat ON" or "üí¨ Chat OFF")
        
    -- SCRIPTS EXTERNOS
    elseif scripts[cmd] then
        LoadScript(scripts[cmd])
        Msg("üî• " .. cmd:upper())
        
    -- GUI DE COMANDOS
    elseif cmd == "cmds" then
        local gui = playerGui:FindFirstChild("CmdGui")
        if gui then gui:Destroy() end
        
        gui = Instance.new("ScreenGui")
        gui.Name = "CmdGui"
        gui.Parent = playerGui
        
        local main = Instance.new("Frame")
        main.Size = UDim2.new(0.4, 0, 0.65, 0)
        main.Position = UDim2.new(0.3, 0, 0.175, 0)
        main.BackgroundColor3 = Color3.new(0.08, 0.08, 0.08)
        main.BorderSizePixel = 0
        main.Parent = gui
        
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 10)
        corner.Parent = main
        
        local title = Instance.new("TextLabel")
        title.Size = UDim2.new(1, -80, 0, 35)
        title.Position = UDim2.new(0, 10, 0, 5)
        title.BackgroundTransparency = 1
        title.Text = "‚ö° COMANDOS ULTRA-R√ÅPIDOS (PREFIX: :)"
        title.TextColor3 = Color3.new(1, 0.2, 0)
        title.Font = Enum.Font.SourceSansBold
        title.TextSize = 16
        title.TextXAlignment = Enum.TextXAlignment.Left
        title.Parent = main
        
        local close = Instance.new("TextButton")
        close.Size = UDim2.new(0, 25, 0, 25)
        close.Position = UDim2.new(1, -30, 0, 5)
        close.Text = "‚úï"
        close.TextColor3 = Color3.new(1, 1, 1)
        close.BackgroundColor3 = Color3.new(0.8, 0.1, 0.1)
        close.BorderSizePixel = 0
        close.Font = Enum.Font.SourceSansBold
        close.TextSize = 14
        close.Parent = main
        
        local closeCorner = Instance.new("UICorner")
        closeCorner.CornerRadius = UDim.new(0, 5)
        closeCorner.Parent = close
        
        close.MouseButton1Click:Connect(function()
            gui:Destroy()
        end)
        
        local chatBtn = Instance.new("TextButton")
        chatBtn.Size = UDim2.new(0, 70, 0, 25)
        chatBtn.Position = UDim2.new(0, 10, 0, 35)
        chatBtn.Text = chatEnabled and "üí¨ ON" or "üí¨ OFF"
        chatBtn.TextColor3 = Color3.new(1, 1, 1)
        chatBtn.BackgroundColor3 = chatEnabled and Color3.new(0.1, 0.7, 0.1) or Color3.new(0.7, 0.1, 0.1)
        chatBtn.BorderSizePixel = 0
        chatBtn.Font = Enum.Font.SourceSansBold
        chatBtn.TextSize = 10
        chatBtn.Parent = main
        
        local chatCorner = Instance.new("UICorner")
        chatCorner.CornerRadius = UDim.new(0, 5)
        chatCorner.Parent = chatBtn
        
        chatBtn.MouseButton1Click:Connect(function()
            chatEnabled = not chatEnabled
            chatBtn.Text = chatEnabled and "üí¨ ON" or "üí¨ OFF"
            chatBtn.BackgroundColor3 = chatEnabled and Color3.new(0.1, 0.7, 0.1) or Color3.new(0.7, 0.1, 0.1)
            Msg(chatEnabled and "üí¨ Chat ON" or "üí¨ Chat OFF")
        end)
        
        local scroll = Instance.new("ScrollingFrame")
        scroll.Size = UDim2.new(1, -20, 1, -75)
        scroll.Position = UDim2.new(0, 10, 0, 65)
        scroll.CanvasSize = UDim2.new(0, 0, 5.5, 0)
        scroll.BackgroundTransparency = 1
        scroll.ScrollBarThickness = 5
        scroll.BorderSizePixel = 0
        scroll.Parent = main
        
        local content = Instance.new("TextLabel")
        content.Size = UDim2.new(1, -10, 0, 2400)
        content.Position = UDim2.new(0, 0, 0, 0)
        content.BackgroundTransparency = 1
        content.TextColor3 = Color3.new(1, 1, 1)
        content.Font = Enum.Font.SourceSans
        content.TextSize = 13
        content.TextWrapped = true
        content.TextXAlignment = Enum.TextXAlignment.Left
        content.TextYAlignment = Enum.TextYAlignment.Top
        content.Parent = scroll
        content.Text = [[‚ö° COMANDOS B√ÅSICOS (PREFIX: :)
:tp [nick] ‚Üí Teleportar para jogador
:tp random ‚Üí Jogador aleat√≥rio
:tpsofa ‚Üí Sof√° secreto
:speed [num] ‚Üí Velocidade
:resetspeed ‚Üí Resetar velocidade
:jp [num] ‚Üí Jump power
:resetjp ‚Üí Resetar jump
:view [nick] ‚Üí Ver c√¢mera
:unview ‚Üí Voltar c√¢mera
:xray ‚Üí Ativar/desativar xray
:invisible ‚Üí Ficar invis√≠vel
:chat ‚Üí Toggle chat

üî• SCRIPTS EXTERNOS
:speedsupreme ‚Üí Speed Supreme ‚úÖ
:coolkid ‚Üí Coolkid Hub ‚ö†Ô∏è
:portalgun ‚Üí Portal Gun ‚ö†Ô∏è
:void ‚Üí Void FE ‚ö†Ô∏è
:gravitygun ‚Üí Gravity Gun ‚ö†Ô∏è
:angelhub ‚Üí Angel Hub ‚ö†Ô∏è
:lanterna ‚Üí Lanterna ‚úÖ
:cmd1 ‚Üí Nameless Admin ‚ö†Ô∏è
:hub1 ‚Üí Chaos Hub ‚ö†Ô∏è
:emotes ‚Üí Emotes ‚úÖ
:gigante ‚Üí Modo Gigante ‚ùì
:bola ‚Üí Virar Bola ‚ùì
:bughub ‚Üí Bug Hub ‚ùì
:infinite ‚Üí Infinite Jump ‚úÖ
:noclip ‚Üí No Clip ‚úÖ
:invisible ‚Üí Ficar Invis√≠vel ‚ùì

üè† TELEPORTS INSTANT√ÇNEOS
:tp salao ‚Üí Sal√£o de festa
:tp sofa ‚Üí Sof√° da casa
:tp doceria ‚Üí Doceria
:tp jogos ‚Üí Sala de jogos
:tp delegacia ‚Üí Delegacia
:tp hospital ‚Üí Hospital
:tp banco ‚Üí Banco principal
:tp bombeiros ‚Üí Bombeiros
:tp cemiterio ‚Üí Cemit√©rio
:tp escola ‚Üí Escola
:tp creche ‚Üí Creche
:tp caixas ‚Üí Loja de caixas
:tp lanches ‚Üí Lanchonete
:tp livraria ‚Üí Livraria
:tp celulares ‚Üí Loja celulares
:tp coffes ‚Üí Cafeteria
:tp veterinario ‚Üí Veterin√°rio
:tp dentista ‚Üí Dentista
:tp banco2 ‚Üí Banco 2
:tp hotel ‚Üí Hotel
:tp hamburgueria ‚Üí Hamburgueria
:tp aeroporto ‚Üí Aeroporto
:tp shopping ‚Üí Shopping
:tp ap1 ‚Üí Apartamento 1
:tp ap2 ‚Üí Apartamento 2
:tp igreja ‚Üí Igreja
:tp praia1 ‚Üí Praia 1
:tp praia2 ‚Üí Praia 2
:tp praia3 ‚Üí Praia 3
:tp abandonada ‚Üí Casa abandonada
:tp maquinas ‚Üí M√°quinas
:tp iate ‚Üí Iate
:tp cabana ‚Üí Cabana
:tp drones ‚Üí Torres de drones
:tp fazenda1 ‚Üí Fazenda 1
:tp fazenda2 ‚Üí Fazenda 2
:tp pra√ßa ‚Üí Pra√ßa central
:tp montanha ‚Üí Montanha
:tp posto ‚Üí Posto de gasolina
:tp loja ‚Üí Loja
:tp parque ‚Üí Parque

‚úÖ = Funcionando 100%
‚ö†Ô∏è = Provavelmente funcionando  
‚ùì = Inst√°vel/Pode funcionar]]
    end
end

-- EVENTO DE CHAT ULTRA-OTIMIZADO (SEM DELAYS)
LocalPlayer.Chatted:Connect(function(msg)
    if not chatEnabled or not msg or msg:sub(1, 1) ~= prefix then return end
    
    local args = {}
    local argCount = 0
    for word in msg:sub(2):lower():gmatch("%S+") do
        argCount = argCount + 1
        args[argCount] = word
    end
    
    if argCount > 0 then
        ProcessCmd(args[1], args)
    end
end)

-- INICIALIZA√á√ÉO INSTANT√ÇNEA
Msg("‚ö° COMANDOS ATIVADOS! (PREFIX: :)")
spawn(function()
    ProcessCmd("cmds", {})
end)
